@page "/bookdetails"
@rendermode InteractiveAuto
@using BlazorCrudApplication.Client.Interfaces
@using BlazorCrudApplication.Client.Model
@using BlazorCrudApplication.Client.Pages.BookManagemenrComponent
@inject IBookDetailsService bookDetailsService
@inject NavigationManager NavigationManager

<AddBookComponent IsEditable="@IsEditable" IsUpdate ="@IsUpdate" BookId="@BookId" />

@code {
    private bool IsEditable = false;
    private bool IsUpdate = false;
    private int BookId = 0;

    protected override void OnInitialized()
    {
        // Extract query parameters from the URL
        var uri = NavigationManager.Uri;
        var queryParams = GetQueryParams(uri);

        if (queryParams.ContainsKey("isEditable"))
        {
            // Convert the query parameter value to a boolean
            IsEditable = bool.Parse(queryParams["isEditable"]);
            IsUpdate = true;
            BookId = int.Parse(queryParams["id"]);
          
        }
    }

    private Dictionary<string, string> GetQueryParams(string uri)
    {
        var queryParams = new Dictionary<string, string>();
        var uriBuilder = new UriBuilder(uri);
        var query = uriBuilder.Query.TrimStart('?');

        if (string.IsNullOrEmpty(query)) return queryParams;

        foreach (var pair in query.Split('&'))
        {
            var keyValue = pair.Split('=');
            if (keyValue.Length == 2)
            {
                queryParams[Uri.UnescapeDataString(keyValue[0])] = Uri.UnescapeDataString(keyValue[1]);
            }
        }

        return queryParams;
    }
}
